# üõ† Technical Architecture

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

*   **Framework**: Next.js 14 (App Router).
*   **Language**: TypeScript (Strict mode).
*   **Styling**: Tailwind CSS + `@tailwindcss/typography` (–¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Markdown).
*   **AI Provider**: Google GenAI SDK (`@google/genai`).
*   **Icons**: Lucide React.
*   **Analytics**: Google Analytics 4 (via `gtag.js`).

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx       # Root layout (Header, Footer, Analytics)
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx         # Landing Page
‚îÇ   ‚îú‚îÄ‚îÄ generate/        # Application Page
‚îÇ   ‚îú‚îÄ‚îÄ features/        # Static Info Pages
‚îÇ   ‚îî‚îÄ‚îÄ globals.css      # Tailwind directives
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ AdGenerator.tsx  # [CORE] Main logic controller
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx       # Navigation
‚îÇ   ‚îú‚îÄ‚îÄ ImageUpload.tsx  # File handling & Base64 conversion
‚îÇ   ‚îî‚îÄ‚îÄ ...              # UI components (Inputs, Selects, Modals)
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ geminiService.ts # API interactions layer
‚îÇ   ‚îî‚îÄ‚îÄ analytics.ts     # GA4 wrapper
‚îú‚îÄ‚îÄ types.ts             # Shared interfaces (AppState, FormData)
‚îî‚îÄ‚îÄ docs/                # Documentation
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (State Management)

–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redux/Zustand –∏–∑-–∑–∞ —É–º–µ—Ä–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –°–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `React.useState` –≤–Ω—É—Ç—Ä–∏ `AdGenerator.tsx`.

### Persistence (–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ `localStorage`:
*   **Key**: `ai_ads_app_state_v1`
*   **Strategy**: Debounce 500ms –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã.
*   **Recovery**: –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–∏–¥—Ä–∞—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ storage.

## –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### 1. Rate Limiting (Client-Side)
–¢–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –±—ç–∫–µ–Ω–¥–∞ (–Ω–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:
*   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º **Sliding Window Log**.
*   –¢–∞–π–º—à—Ç–∞–º–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `localStorage` (`ai_ads_quota_timestamps`).
*   –õ–∏–º–∏—Ç: 15 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É (RPM).
*   –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.

### 2. –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:
1.  `input type="file"` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.
2.  `FileReader` –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Base64.
3.  –°—Ç—Ä–æ–∫–∞ Base64 —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å—Ç–µ–π—Ç–µ –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `geminiService.ts`.
4.  –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ API –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤—ã—Ä–µ–∑–∞–µ—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å `data:image/...;base64,`.

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ Markdown
AI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown. –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
*   `react-markdown` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥.
*   Tailwind Typography (`prose` –∫–ª–∞—Å—Å) ‚Äî —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è HTML-—Ç–µ–≥–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –í —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ API Key Google Gemini –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (`NEXT_PUBLIC_API_KEY`).
–≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è MVP –∏–ª–∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞, –Ω–æ **–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞**.

**–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Backend (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):**
1.  –°–æ–∑–¥–∞—Ç—å API Route –≤ Next.js (`app/api/generate/route.ts`).
2.  –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –∏–∑ `geminiService.ts` –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
3.  –°–ø—Ä—è—Ç–∞—Ç—å API Key –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.
4.  –î–æ–±–∞–≤–∏—Ç—å Rate Limiting –ø–æ IP –∞–¥—Ä–µ—Å—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Redis).